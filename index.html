<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Play Video From OS</title>
    <link rel="icon" href="data:," />
    <script>
      async function getFile() {
        try {
          // Opções para permitir apenas seleção de vídeos
          const options = {
            types: [
              {
                description: "Video Files",
                accept: {
                  "video/*": [".mp4", ".mkv", ".webm"],
                },
              },
            ],
          }

          // Isto abrirá o seletor de arquivos
          const [fileHandle] = await window.showOpenFilePicker(options)
          return fileHandle
        } catch (e) {
          console.error(e)
          // O usuário cancelou a seleção do arquivo ou ocorreu um erro
        }
      }

      async function readFile(fileHandle) {
        const file = await fileHandle.getFile()
        return file
      }

      async function playVideo(file) {
        console.log(file)
        const videoUrl = URL.createObjectURL(file)
        console.log(`url: ${videoUrl}`)
        const videoElement = document.querySelector("#loaded-video")
        videoElement.src = videoUrl
        videoElement.controls = true
        videoElement.play()
      }

      async function pickAndPlayVideo() {
        const fileHandle = await getFile()
        if (fileHandle) {
          const file = await readFile(fileHandle)
          await playVideo(file)
        }
      }
    </script>
  </head>
  <body
    style="
      min-width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 12px;
    "
  >
    <video
      src=""
      id="loaded-video"
      style="width: 600px; background-color: rgb(73, 73, 73)"
    ></video>
    <button id="btnPickVideo">Escolher e Reproduzir Vídeo</button>
    <script>
      // JavaScript para acionar a função pickAndPlayVideo
      document
        .getElementById("btnPickVideo")
        .addEventListener("click", pickAndPlayVideo)
    </script>
  </body>
</html>
